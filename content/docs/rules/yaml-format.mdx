---
title: YAML Rule Format
description: Complete reference for Veto's YAML rule syntax.
---

Each rule file (e.g. `veto/rules/policy.yaml`) can contain one or more rules.

## Full schema

```yaml
rules:
  - id: unique-rule-id           # [Required] Unique identifier
    name: Human readable name    # [Required] Descriptive name for logging
    enabled: true                # [Optional] Default: true
    severity: high               # [Optional] critical, high, medium, low, info
    action: block                # [Required] block, warn, log, allow, require_approval

    # Scope: which tools does this rule apply to?
    tools:                       # [Optional] List of tool names
      - make_payment             # If omitted, applies to ALL tools

    # Static conditions (optional):
    # Evaluated locally before LLM validation
    conditions:
      - field: arguments.amount  # Dot notation for nested args
        operator: greater_than   # See operators table below
        value: 1000

    # Condition groups (optional):
    # OR-of-ANDs — use instead of `conditions` for compound logic
    condition_groups:
      - - field: arguments.amount
          operator: greater_than
          value: 10000
      - - field: arguments.currency
          operator: not_in
          value: ["USD", "EUR"]
        - field: arguments.amount
          operator: greater_than
          value: 1000

    # Description (optional):
    # Natural language guidance for the validation LLM
    description: "Ensure the payment recipient is a verified vendor."
```

## Fields

| Field | Required | Default | Description |
|-------|----------|---------|-------------|
| `id` | Yes | — | Unique identifier for the rule |
| `name` | Yes | — | Human-readable name for logging |
| `enabled` | No | `true` | Whether the rule is active |
| `severity` | No | `medium` | `critical`, `high`, `medium`, `low`, `info` |
| `action` | Yes | — | `block`, `warn`, `log`, `allow`, `require_approval` |
| `tools` | No | All tools | List of tool names this rule applies to |
| `conditions` | No | — | Static constraint checks (AND logic) |
| `condition_groups` | No | — | Compound constraint checks (OR-of-ANDs logic) |
| `description` | No | — | Natural language guidance for LLM validation |

## Condition operators

| Operator | Type | Description | Example |
|----------|------|-------------|---------|
| `equals` | any | Exact match | `value: "admin"` |
| `not_equals` | any | Must not equal | `value: "admin"` |
| `contains` | string | Substring match | `value: "password"` |
| `not_contains` | string | Must NOT contain | `value: "secret"` |
| `starts_with` | string | Prefix match | `value: "/etc"` |
| `ends_with` | string | Suffix match | `value: ".exe"` |
| `matches` | string | Regex pattern (max 256 chars, ReDoS-safe) | `value: "^[^@]+@company\\.com$"` |
| `in` | string/number | Value in allowlist | `value: ["USD", "EUR"]` |
| `not_in` | string/number | Value NOT in denylist | `value: ["admin", "root"]` |
| `greater_than` | number | Numeric > comparison | `value: 1000` |
| `less_than` | number | Numeric < comparison | `value: 0` |

## Condition groups (OR logic)

When you need compound logic beyond simple AND, use `condition_groups` instead of `conditions`. Each group is an array of conditions joined with AND, and groups are joined with OR.

Only use one of `conditions` or `condition_groups` per rule. If both are set, `conditions` takes precedence.

```yaml
rules:
  - id: restrict-high-risk-transfers
    name: Block high-risk financial transfers
    action: block
    tools:
      - transfer_funds
    condition_groups:
      # Group 1: Large transfers to any destination
      - - field: arguments.amount
          operator: greater_than
          value: 50000

      # Group 2: Any transfer to a non-approved currency AND amount > 1000
      - - field: arguments.currency
          operator: not_in
          value: ["USD", "EUR", "GBP"]
        - field: arguments.amount
          operator: greater_than
          value: 1000
```

This rule triggers if **either** group matches:
- Amount exceeds 50,000 (any currency), **OR**
- Amount exceeds 1,000 in a non-approved currency

## Rule matching logic

### 1. Rule selection

Veto selects rules based on the `tools` list:

- **Tool-specific rules**: If a rule lists specific tools (e.g. `tools: [make_payment]`), it only applies when those tools are called
- **Global rules**: If `tools` is missing or empty `[]`, the rule activates for every tool call

### 2. Validation execution

For each intercepted tool call, Veto aggregates all applicable rules (global + specific) and validates:

1. **Static conditions** — if `conditions` are defined, they're checked first. If a condition matches, the rule triggers immediately
2. **Semantic validation** — if no static conditions match (or none exist), the rule's `name` and `description` are sent to the LLM for semantic evaluation

## Examples

### Block large financial transfers

```yaml
rules:
  - id: limit-transfers
    name: Limit large transfers
    action: block
    severity: critical
    tools:
      - transfer_funds
      - send_payment
    conditions:
      - field: arguments.amount
        operator: greater_than
        value: 10000
```

### Prevent file access outside project

```yaml
rules:
  - id: restrict-file-paths
    name: Restrict file access to project directory
    action: block
    severity: high
    tools:
      - read_file
      - write_file
    conditions:
      - field: arguments.path
        operator: starts_with
        value: "/etc"
```

### Global policy via LLM

```yaml
rules:
  - id: no-pii-disclosure
    name: Prevent PII disclosure
    action: block
    severity: critical
    description: >
      Block any tool call that would expose personally identifiable
      information such as social security numbers, credit card numbers,
      or home addresses to external services.
```
