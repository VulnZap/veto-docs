---
title: Approvals API
description: Endpoints for human-in-the-loop approval workflows — list, create, poll, and resolve approvals.
---

The approvals API powers Veto's human-in-the-loop (HITL) workflow. When a policy requires human review, an approval record is created and the SDK polls until a human resolves it.

HITL requires the **Team** plan or above.

## GET /v1/approvals/pending

List all pending approvals for the current organization.

### Headers

| Header | Required | Description |
|--------|----------|-------------|
| `X-Veto-API-Key` or `Authorization` | Yes | API key or Bearer JWT |

### Response

```json
{
  "data": [
    {
      "id": "apr_abc123def456",
      "toolName": "transfer_funds",
      "arguments": { "amount": 5000, "to": "vendor-123" },
      "status": "pending",
      "expiresAt": "2025-01-15T10:35:00Z",
      "createdAt": "2025-01-15T10:30:00Z"
    }
  ]
}
```

## POST /v1/approvals

Create an approval request manually. Useful for triggering HITL outside the normal validation flow.

### Headers

| Header | Required | Description |
|--------|----------|-------------|
| `X-Veto-API-Key` or `Authorization` | Yes | API key or Bearer JWT |
| `Content-Type` | Yes | `application/json` |

### Body

```json
{
  "decisionId": "d7f2a1b3-4c5e-6f78-9a0b-1c2d3e4f5a6b",
  "toolName": "transfer_funds",
  "arguments": { "amount": 5000, "to": "vendor-123" },
  "expiresInSeconds": 3600
}
```

| Field | Type | Required | Description |
|-------|------|----------|-------------|
| `decisionId` | `string (UUID)` | No | Link to an existing decision record |
| `toolName` | `string` | Yes | Name of the tool awaiting approval |
| `arguments` | `object` | No | Tool call arguments for reviewer context |
| `expiresInSeconds` | `number` | No | TTL in seconds (60–86400, default: 3600) |

### Response (201)

```json
{
  "id": "apr_abc123def456",
  "toolName": "transfer_funds",
  "status": "pending",
  "expiresAt": "2025-01-15T11:30:00Z",
  "createdAt": "2025-01-15T10:30:00Z"
}
```

## GET /v1/approvals/:id

Poll an approval record. The SDK calls this automatically — you do not need to call it directly.

### Headers

| Header | Required | Description |
|--------|----------|-------------|
| `X-Veto-API-Key` or `Authorization` | Yes | API key or Bearer JWT |

### Path parameters

| Parameter | Type | Description |
|-----------|------|-------------|
| `id` | `string` | The approval ID |

### Response

### Pending

```json
{
  "id": "apr_abc123def456",
  "status": "pending",
  "toolName": "transfer_funds",
  "arguments": { "amount": 5000, "to": "vendor-123" },
  "createdAt": "2025-01-15T10:30:00Z",
  "expiresAt": "2025-01-15T10:35:00Z"
}
```

### Approved

```json
{
  "id": "apr_abc123def456",
  "status": "approved",
  "toolName": "transfer_funds",
  "resolvedBy": "user@company.com",
  "resolvedAt": "2025-01-15T10:31:15Z"
}
```

### Denied

```json
{
  "id": "apr_abc123def456",
  "status": "denied",
  "toolName": "transfer_funds",
  "resolvedBy": "user@company.com",
  "resolvedAt": "2025-01-15T10:31:15Z"
}
```

### Expired

```json
{
  "id": "apr_abc123def456",
  "status": "expired",
  "toolName": "transfer_funds",
  "expiresAt": "2025-01-15T10:35:00Z"
}
```

### Response fields

| Field | Type | Description |
|-------|------|-------------|
| `id` | `string` | Approval record ID |
| `status` | `"pending" \| "approved" \| "denied" \| "expired"` | Current status |
| `toolName` | `string` | Name of the tool awaiting approval |
| `arguments` | `object?` | Tool call arguments (included while pending) |
| `resolvedBy` | `string?` | Who resolved the approval |
| `resolvedAt` | `string?` | ISO 8601 timestamp of resolution |
| `createdAt` | `string?` | ISO 8601 timestamp of creation |
| `expiresAt` | `string?` | ISO 8601 timestamp of expiration |

## POST /v1/approvals/:id/resolve

Resolve a pending approval — approve or deny.

### Headers

| Header | Required | Description |
|--------|----------|-------------|
| `X-Veto-API-Key` or `Authorization` | Yes | API key or Bearer JWT |
| `Content-Type` | Yes | `application/json` |

### Path parameters

| Parameter | Type | Description |
|-----------|------|-------------|
| `id` | `string` | The approval ID to resolve |

### Body

```json
{
  "action": "approve",
  "resolvedBy": "user@company.com"
}
```

| Field | Type | Required | Description |
|-------|------|----------|-------------|
| `action` | `"approve" \| "deny"` | Yes | Resolution action |
| `resolvedBy` | `string` | Yes | Identifier of the person resolving |

### Response

```json
{
  "id": "apr_abc123def456",
  "status": "approved",
  "resolvedBy": "user@company.com",
  "resolvedAt": "2025-01-15T10:31:15Z"
}
```

### Errors

| Status | Code | Description |
|--------|------|-------------|
| 404 | `not_found` | Approval ID does not exist |
| 410 | `expired` | Approval has already expired |
| 400 | `invalid_status` | Approval is already resolved |

## SDK behavior

The SDK handles polling automatically. The flow:

1. Validate endpoint returns `{ decision: "require_approval", approval_id: "apr_..." }`
2. SDK fires the `onApprovalRequired` / `on_approval_required` hook
3. SDK polls `GET /v1/approvals/:id` every 2 seconds (configurable)
4. When status changes from `pending`, SDK returns the decision to the agent
5. If the poll exceeds the timeout (default 5 minutes), SDK throws `ApprovalTimeoutError`

```
Agent calls tool
       │
       ▼
SDK validates with cloud ──── allow ──── Tool executes
       │
       ├── deny ──── ToolCallDeniedError
       │
       └── require_approval
              │
              ▼
       Fire onApprovalRequired hook
              │
              ▼
       Poll GET /v1/approvals/:id
              │
       ┌──────┼──────┐
       │      │      │
  approved  denied  expired/timeout
       │      │      │
  Tool runs  Error  Error
```
